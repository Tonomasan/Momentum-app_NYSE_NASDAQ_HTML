<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Á±≥ÂõΩÊ†™„É¢„É°„É≥„Çø„É†Ê§úÁ¥¢</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        table {
            width: 100%;
            border-collapse: collapse;
        }
        th, td {
            border: 1px solid #ddd;
            padding: 8px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        .slider-container {
            margin-bottom: 20px;
        }
    </style>
</head>
<body>
    <h1>üìà Á±≥ÂõΩÊ†™„É¢„É°„É≥„Çø„É†Ê§úÁ¥¢</h1>
<!--     
    <div class="slider-container">
        <label>1„É∂Êúà„É¢„É°„É≥„Çø„É†ÁØÑÂõ≤: </label>
        <input type="range" id="slider-1m-min" min="-50" max="100" step="1" value="-10">
        <input type="range" id="slider-1m-max" min="-50" max="100" step="1" value="30">
        <span id="range-1m">-10 ~ 30</span>
    </div>
    
    <div class="slider-container">
        <label>3„É∂Êúà„É¢„É°„É≥„Çø„É†ÁØÑÂõ≤: </label>
        <input type="range" id="slider-3m-min" min="-50" max="100" step="1" value="-10">
        <input type="range" id="slider-3m-max" min="-50" max="100" step="1" value="30">
        <span id="range-3m">-10 ~ 30</span>
    </div>
    
    <div class="slider-container">
        <label>6„É∂Êúà„É¢„É°„É≥„Çø„É†ÁØÑÂõ≤: </label>
        <input type="range" id="slider-6m-min" min="-50" max="100" step="1" value="-10">
        <input type="range" id="slider-6m-max" min="-50" max="100" step="1" value="30">
        <span id="range-6m">-10 ~ 30</span>
    </div> -->
    
    <button id="download-btn">üì• „Éá„Éº„Çø„Çí„ÉÄ„Ç¶„É≥„É≠„Éº„Éâ</button>
    
    <style>
        .overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            justify-content: center;
            align-items: center;
        }
        .popup {
            background: white;
            padding: 20px;
            border-radius: 10px;
            position: relative;
        }
        .popup-bg {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }
        .close {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 20px;
            cursor: pointer;
        }
    </style>
    <div>‚ÄªË°å„Çí„ÇØ„É™„ÉÉ„ÇØ„Åô„Çã„Å®„Åù„ÅÆÈäòÊüÑ„ÅÆ„ÉÅ„É£„Éº„Éà„Çí„Éù„ÉÉ„Éó„Ç¢„ÉÉ„Éó„ÅßÈñã„Åç„Åæ„Åô„ÄÇ</div>
    <table>
        <thead>
            <tr>
                <th>Ticker</th>
                <th>1„É∂Êúà„É¢„É°„É≥„Çø„É†</th>
                <th>3„É∂Êúà„É¢„É°„É≥„Çø„É†</th>
                <th>6„É∂Êúà„É¢„É°„É≥„Çø„É†</th>
            </tr>
        </thead>
        <tbody id="stock-table-body"></tbody>
    </table>
    <div id="popup-chart" class="overlay">
        <div class="popup-bg" onclick="closePopup()"></div>
        <div class="popup">
            <h2 id="chart_symbol">SYMBOL</h2>
            <a class="close" href="javascript:void(0);" onclick="closePopup()">&times;</a>
            <div id="chart"></div>
        </div>
    </div>

    <!-- jQRangeSlider „ÅÆCSS„Å®JS„ÇíËøΩÂä† -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-ui-dist/jquery-ui.min.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jqrangeslider/css/iThing.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-ui-dist/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jqrangeslider/js/jQAllRangeSliders-withRuler-min.js"></script>

    <div class="slider-container">
        <label>1„É∂Êúà„É¢„É°„É≥„Çø„É†ÁØÑÂõ≤: </label>
        <div id="slider-1m"></div>
        <span id="range-1m">-10 ~ 30</span>
    </div>
    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jquery-ui-dist/jquery-ui.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jqrangeslider/js/jQAllRangeSliders-withRuler-min.js"></script>
    
    <script>
        $(document).ready(function() {
            $("#slider-1m").rangeSlider({
                bounds: { min: -50, max: 100 },
                defaultValues: { min: -10, max: 30 },
                step: 1,
                arrows: true,
                range: { min: 1 }
            });
    
            $("#slider-1m").on("valuesChanged", function(e, data) {
                const min1m = data.values.min;
                const max1m = data.values.max;
                $("#range-1m").text(`${min1m} ~ ${max1m}`);
            });
        });
    </script>
    

    <script>
        function openPopup(symbol) {
            document.getElementById("chart_symbol").innerText = symbol;
            document.getElementById("popup-chart").style.display = "flex";
            document.getElementById("chart").innerHTML = "";
            let tradingSymbol = symbol.includes(":") ? symbol : "NASDAQ:" + symbol;
            new TradingView.widget({
                "container_id": "chart",
                "width": "100%",
                "height": "400",
                "symbol": tradingSymbol,
                "interval": "D",
                "theme": "light",
                "style": "1",
                "locale": "en",
                "toolbar_bg": "#f1f3f6",
                "enable_publishing": false,
                "hide_side_toolbar": false,
                "allow_symbol_change": true,
                "save_image": false
            });
        }
        function closePopup() {
            document.getElementById("popup-chart").style.display = "none";
        }
        async function loadStockData() {
            const response = await fetch("momentum_data_yf.csv");
            const text = await response.text();
            const rows = text.split("\n").slice(1).filter(row => row.trim() !== "");
            const stocks = rows.map(row => {
                const cols = row.split(",").map(col => col.trim());
                return { ticker: cols[0] || "", momentum1m: parseFloat(cols[1]) || 0, momentum3m: parseFloat(cols[2]) || 0, momentum6m: parseFloat(cols[3]) || 0 };
            }).filter(stock => stock.ticker !== "");
            return stocks;
        }
        function updateTable(stocks) {
            const slider = document.getElementById("slider-1m");
            const values = slider.value.split(',');
            const min1m = parseFloat(values[0]);
            const max1m = parseFloat(values[1]);
            document.getElementById("range-1m").innerText = `${min1m} ~ ${max1m}`;
            const filteredStocks = stocks.filter(stock => 
                stock.momentum1m >= min1m && stock.momentum1m <= max1m
            );
            const tableBody = document.getElementById("stock-table-body");
            tableBody.innerHTML = "";
            filteredStocks.forEach(stock => {
                const row = document.createElement("tr");
                row.dataset.ticker = stock.ticker;
                row.innerHTML = `<td>${stock.ticker}</td><td>${stock.momentum1m}</td><td>${stock.momentum3m}</td><td>${stock.momentum6m}</td>`;
                row.addEventListener("click", () => openPopup(stock.ticker));
                tableBody.appendChild(row);
            });
        }
        document.addEventListener("DOMContentLoaded", async function() {
            const stocks = await loadStockData();
            updateTable(stocks);
            document.getElementById("slider-1m").addEventListener("input", () => updateTable(stocks));
        });
    </script>
    
    
    
    
</body>
</html>


